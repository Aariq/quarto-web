{
  "hash": "97df58d45ed301f6cd547e6537b83e0c",
  "result": {
    "markdown": "---\ntitle: \"Data Sources\"\n---\n\nTBF: Turn these into interactive documents.\n\nOne of Quarto's core capabilities is its ability to embed output from Python, R, etc. \nWhen the output produced by a Python or R computation is required in interactive documents, there are two possible simple approaches.\n\n## File attachments\n\nThe first approach uses the notion of \"file attachments\" from Observable's runtime system. If you include a file as a resource from a Quarto project (FIXME: where in the docs do we describe resources?), then you can directly use that file in Javascript.\n\nLet's take a NOAA's Monthly CO2 concentration data from Mauna Loa, obtained from their website (and mildly processed to remove comments):\n\n```{ojs}\ndata = {\n  const v = await FileAttachment(\"co2_mm_mlo_clean.csv\").csv();\n  return v.map(d => { \n    d[\"decimal date\"] = Number(d[\"decimal date\"]);\n    d.average = Number(d.average); \n    return d; \n  });\n}\nPlot.plot({\n  marks: [\n    Plot.line(data, {x: \"decimal date\", y: \"average\"}, { stroke: \"black\" })\n  ]})\n```\n\n## `ojs_define`\n\nSometimes, you might want to do some preprocessing of the data in R or Python before visualizing it in your interactive document. Although it's often possible to use the file system and file attachments to communicate such values, the most direct way to do this is using the `ojs_define` command, which is available in both R and Python:\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output-stderr}\n```\n── Attaching packages ─────────────────────────────────────── tidyverse 1.3.0 ──\n```\n:::\n\n::: {.cell-output-stderr}\n```\n✓ ggplot2 3.3.2     ✓ purrr   0.3.4\n✓ tibble  3.1.3     ✓ dplyr   1.0.7\n✓ tidyr   1.1.2     ✓ stringr 1.4.0\n✓ readr   2.0.0     ✓ forcats 0.5.0\n```\n:::\n\n::: {.cell-output-stderr}\n```\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\nx dplyr::filter() masks stats::filter()\nx dplyr::lag()    masks stats::lag()\n```\n:::\n\n```{.r .cell-code}\ndf = read.csv(\"co2_mm_mlo_clean.csv\", row.names=NULL)\nojs_define(co2 = df %>% group_by(year) %>% summarize(max = max(average)))\n```\n:::\n\n```{ojs}\nPlot.plot({\n  marks: [\n    Plot.line(transpose(co2), {x: \"year\", y: \"max\"}, { stroke: \"black\" })\n  ]})\n```\n\n```{ojs}\n//| echo: false\n//| output: false\ntranspose = function(df)\n{\n  const keys = Object.keys(df);\n  return df[keys[0]]\n    .map((v, i) => Object.fromEntries(keys.map(key => [key, df[key][i] || undefined])))\n    .filter(v => Object.values(v).every(e => e !== undefined));\n}\n```",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script type=\"ojs-define\">\n{\"contents\":[{\"name\":\"co2\",\"value\":{\"year\":[1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013,2014,2015,2016,2017,2018,2019,2020,2021],\"max\":[317.51,318.29,320.04,320.58,321.02,322.25,322.26,322.17,324.08,325,325.57,327.38,328.13,328.93,330.07,332.48,333.19,333.95,334.74,336.93,338.02,339.26,341.45,343.04,344.77,346.14,347.78,349.28,350.52,352.15,354.35,355.95,357.38,359.23,359.71,360.3,361.78,363.83,365.25,366.77,369.56,371.15,371.98,374.03,375.93,378.78,380.8,382.64,385.22,386.78,388.78,390.36,393.21,394.41,396.93,400.02,401.96,404.15,407.9,409.89,411.44,414.86,417.31,419.13]}}]}\n</script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": null
  }
}